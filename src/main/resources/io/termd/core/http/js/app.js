(function(e){function t(t){for(var o,l,s=t[0],c=t[1],a=t[2],d=0,f=[];d<s.length;d++)l=s[d],i[l]&&f.push(i[l][0]),i[l]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(t);while(f.length)f.shift()();return r.push.apply(r,a||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(o=!1)}o&&(r.splice(t--,1),e=l(l.s=n[0]))}return e}var o={},i={app:0},r=[];function l(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.m=e,l.c=o,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)l.d(n,o,function(t){return e[t]}.bind(null,o));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var a=0;a<s.length;a++)t(s[a]);var u=c;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var o=n("64a9"),i=n.n(o);i.a},"0791":function(e,t,n){"use strict";var o=n("4aa7"),i=n.n(o);i.a},"4aa7":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);var o,i,r=n("2b0e"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("HelloWorld",{attrs:{msg:"Welcome to Arthas Web Console"}})],1)},s=[],c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"layout"},[n("Layout",[n("Header",[n("Menu",{attrs:{mode:"horizontal",theme:"dark","active-name":"1"}},[n("div",{staticClass:"layout-logo"},[n("Button",{attrs:{type:"info",icon:"md-menu"},on:{click:function(t){e.isConfigShow=!0}}},[e._v("Connection Config")])],1),n("div",{staticClass:"layout-nav"},[n("label",{staticStyle:{color:"white"}},[n("h1",[e._v(e._s(e.msg))])])])])],1),n("Content",{style:{padding:"10px 10px"}},[n("Card",{attrs:{id:"terminal-card"}},[n("div",{staticStyle:{"min-height":"600px",height:"100%"}},[n("div",{ref:"xtermPanel",attrs:{id:"terminal"}})])])],1),n("Drawer",{attrs:{title:"Basic Drawer",placement:"left",closable:!1},model:{value:e.isConfigShow,callback:function(t){e.isConfigShow=t},expression:"isConfigShow"}},[n("Form",{attrs:{model:e.connectionConfig,"label-width":80}},[n("FormItem",{attrs:{label:"IP"}},[n("Input",{attrs:{placeholder:"Please Enter IP address"},model:{value:e.connectionConfig.ip,callback:function(t){e.$set(e.connectionConfig,"ip",t)},expression:"connectionConfig.ip"}})],1),n("FormItem",{attrs:{label:"Port"}},[n("Input",{attrs:{placeholder:"Please Enter Port"},model:{value:e.connectionConfig.port,callback:function(t){e.$set(e.connectionConfig,"port",t)},expression:"connectionConfig.port"}})],1),n("FormItem",[n("Button",{attrs:{type:"primary"},on:{click:e.startConnect}},[e._v("Connect")])],1),n("FormItem",[n("Button",{attrs:{type:"error"},on:{click:e.disconnect}},[e._v("Disconnect")])],1)],1)],1)],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.isXtermShow,expression:"isXtermShow"}],staticClass:"fullSc"},[n("Button",{attrs:{shape:"circle",icon:"ios-expand"},on:{click:e.xtermFullScreen}})],1)],1)},a=[],u=(n("5332"),n("cf05")),d=n.n(u),f=n("59bf");function p(e,t){let n="ws://"+e+":"+t+"/ws";o=new WebSocket(n)}function g(){return o}function h(e,t){i=new f["Terminal"]({cols:e,rows:t,screenReaderMode:!0,rendererType:"canvas",convertEol:!0})}function m(){return i}var w=n("1157"),v=n.n(w),y={name:"HelloWorld",props:{msg:String},data(){return{logo:d.a,connectionConfig:{ip:"127.0.0.1",port:8563},connectionLoading:!1,isConfigShow:!1,isXtermShow:!1}},methods:{startConnect(){if(console.log("connecting"),""===this.connectionConfig.ip||""===this.connectionConfig.port)return void this.$Message.error("ip or port can not be empty");this.connectionLoading=!0,p(this.connectionConfig.ip,this.connectionConfig.port);let e=g(),t=this;e.onerror=function(){t.$Message.error("connect error"),this.connectionLoading=!1},e.onopen=function(){console.log("open"),this.connectionLoading=!1,t.isConfigShow=!1,t.isXtermShow=!0,t.$Message.success("connect successfully!");let n=t.getTerminalSize();console.log("terminalSize"),console.log(n),h(n.cols,n.rows);var o=m();e.onmessage=function(e){if("message"===e.type){let t=e.data;o.write(t)}},o.open(document.getElementById("terminal")),o.on("data",function(t){e.send(JSON.stringify({action:"read",data:t}))}),e.send(JSON.stringify({action:"resize",cols:n.cols,rows:n.rows})),window.setInterval(function(){e.send(JSON.stringify({action:"read",data:""}))},3e4)}},disconnect(){let e=g(),t=m();try{e.onmessage=null,e.onclose=null,t.destroy(),this.$Message.success("connection was closed successfully!")}catch(n){this.$Message.error("no connection!")}finally{this.isConfigShow=!1}},xtermFullScreen(){let e=document.getElementById("terminal-card");this.requestFullScreen(e)},xtermResizeHandler(){let e=g(),t=this.getTerminalSize();console.log("after"),console.log(t),e.send(JSON.stringify({action:"resize",cols:t.cols,rows:t.rows}));let n=m();n.resize(t.cols,t.rows)},requestFullScreen(e){var t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen;if(t)t.call(e);else if("undefined"!==typeof window.ActiveXObject){var n=new ActiveXObject("WScript.Shell");null!==n&&n.SendKeys("{F11}")}},getCharSize(){let e=v()("<div />").attr({role:"listitem"}),t=v()("<div />").html("qwertyuiopasdfghjklzxcvbnm");e.append(t),v()("html body").append(e);let n={width:t.outerWidth()/26,height:t.outerHeight(),left:e.outerWidth()-t.outerWidth(),top:e.outerHeight()-t.outerHeight()};return e.remove(),n},getWindowSize(){let e=window,t="inner";"innerWidth"in window||(t="client",e=document.documentElement||document.body);var n=document.getElementById("terminal-card"),o=n.getBoundingClientRect();return{width:o.width,height:e[t+"Height"]-o.top}},getTerminalSize(){let e=this.getCharSize(),t=this.getWindowSize();return console.log("charsize"),console.log(e),console.log("windowSize"),console.log(t),{cols:Math.floor((t.width-e.left)/10),rows:Math.floor((t.height-e.top)/17)}}},mounted(){window.addEventListener("resize",this.xtermResizeHandler)}},S=y,b=(n("0791"),n("2877")),C=Object(b["a"])(S,c,a,!1,null,"657fa6f3",null);C.options.__file="HelloWorld.vue";var x=C.exports,z={name:"app",components:{HelloWorld:x}},_=z,O=(n("034f"),Object(b["a"])(_,l,s,!1,null,null,null));O.options.__file="App.vue";var k=O.exports,F=n("e069"),W=n.n(F);n("dcad");r["default"].config.productionTip=!1,r["default"].use(W.a),new r["default"]({render:e=>e(k)}).$mount("#app")},"64a9":function(e,t,n){},cf05:function(e,t,n){e.exports=n.p+"img/logo.png"}});
//# sourceMappingURL=app.js.map